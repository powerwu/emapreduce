# 临时查询

临时查询主要针对即席查询（Ad Hoc）的场景，面向数据科学家和数据分析师，其主要使用工具为SQL。运行临时查询作业时，将会在页面下方显示日志和查询结果。E-MapReduce数据开发支持Shell、SparkSQL、Spark Shell和HiveSQL四种类型的临时查询作业。

已创建项目或已被加入到项目中，详情请参见[项目管理](/intl.zh-CN/数据开发/项目管理.md)。

## 新建作业

1.  通过主账号登录[阿里云 E-MapReduce 控制台](https://emr.console.aliyun.com)。

2.  单击上方的**数据开发**页签。

3.  在**项目列表**页面，单击对应项目所在行的**作业编辑**。

4.  在**作业编辑**页面，单击页面左侧的![search_temp](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2065158951/p70532.png)图标。

5.  在**临时查询**区域，右键单击待操作的文件夹，选择**新建作业**。

6.  在**新建交互式作业**对话框中，输入**作业名称**、**作业描述**，选择**作业类型**。

    **说明：** 创建作业时作业类型一经确定，不能修改。

7.  单击**确定**。

    您还可以通过在文件夹上单击右键，进行**新建子文件夹**、**重命名文件夹**和**删除文件夹**操作。


## 设置作业

各个具体作业类型的开发与设置，请参见[作业](/intl.zh-CN/数据开发/作业/Shell作业配置.md)部分。 以下介绍的是作业的**基础设置**、**高级设置**和**告警设置**。

1.  单击页面右上角的**作业设置**。

2.  在**作业设置**页面，设置基础信息。

    |参数|描述|
    |--|--|
    |**作业概要**|    -   **失败重试次数**：设置在工作流运行到该作业失败时，最大支持重试的次数。

**说明：** 如果直接在作业页面运行作业，该选项不会生效。

    -   **失败策略**：设置在工作流运行到该作业失败时，是继续执行下一个工作流节点还是暂停当前工作流。
    -   **作业描述**：可修改作业的描述。 |
    |**运行资源**|单击右侧的![加号](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0259929951/p66254.png)，添加作业执行所依赖的jar包或UDF等资源。您需要将资源先上传至OSS，然后在**运行资源**中直接添加即可。|
    |**配置参数**|指定作业代码中所引用的变量的值。您可以在代码中引用变量，格式为$\{变量名\}。 单击右侧的![加号](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0259929951/p66254.png)，添加Key和Value。其中，Key为变量名，Value为变量的值。另外，您还可以根据调度启动时间在此配置时间变量，详情请参见[作业日期设置](/intl.zh-CN/数据开发/作业/作业日期设置.md)。 |

3.  在**作业设置**页面，单击**高级设置**。

    |配置项|说明|
    |---|--|
    |**模式**|    -   **提交节点**包括以下两种模式，详情请参见[作业编辑](/intl.zh-CN/数据开发/作业编辑.md)中的作业提交模式说明。
        -   **在 Worker 节点提交**：作业通过Launcher在YARN上分配资源进行提交。
        -   **在 Header/Gateway 节点提交**：作业在分配的机器上直接运行。
    -   **预期最大运行时长**：0~10800秒。 |
    |**环境变量**|添加作业执行的环境变量，也可以在作业脚本中直接export环境变量。     -   示例一：一个shell类型的任务，内容是`echo ${ENV_ABC}`。如果此处设置了一个环境变量 `ENV_ABC=12345`，则`echo`命令的输出结果为 `12345`。
    -   示例二：一个shell类型的作业，内容是`java -jar abc.jar`，其中abc.jar的内容是：

        ```
public static void main(String[] args) {System.out.println(System.getEnv("ENV_ABC"));}
        ```

您得到结果是`12345`。此处环境变量的设置相当于执行了以下脚本：

        ```
export ENV_ABC=12345
java -jar abc.jar
        ``` |
    |**调度参数**|设置作业运行YARN 队列、内存、虚拟核数、优先级和执行用户等信息。当未设置这些参数时，作业会直接采用Hadoop集群的默认值。 **说明：** 内存设置用于设置启动器Launcher的内存配额。 |

4.  高级设置完成后，单击**告警设置**，设置作业的告警配置项。

    |配置项|说明|
    |---|--|
    |**执行失败**|设置作业执行失败时，是否通知到用户告警组或钉钉告警组。|
    |**启动超时**|设置作业启动失败时，是否通知到用户告警组或钉钉告警组。|
    |**作业执行超时**|设置作业执行超时时，是否通知到用户告警组或钉钉告警组。|


## 执行作业

单击右上方的**运行**，执行作业。

作业运行后，您可以在页面下方的日志页签中，查看作业的运行日志。

## 编辑锁

在编辑作业时，您可以单击右上角的**上锁**为该作业加上编辑锁，保证此时只有您可以编辑作业，项目其他成员无法编辑该作业。只有解锁之后，项目中其他成员才可以编辑该作业。

**说明：** 上锁之后，只有上锁的成员和主账号管理员能够解锁。

